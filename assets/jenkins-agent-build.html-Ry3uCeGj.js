const e=JSON.parse('{"key":"v-7ef3cef6","path":"/md/devops/jenkins/jenkins-agent-build.html","title":"Jenkins agent镜像构建","lang":"zh-CN","frontmatter":{"title":"Jenkins agent镜像构建","icon":"fab fa-docker","tag":"Jenkins","description":"FROM jenkins/inbound-agent:latest-jdk11 ARG MAVEN_VERSION=3.6.3 ARG KUBECTL_VERSION=v1.22.1 USER root # tool RUN sed -i \\"s/deb.debian.org/mirrors.aliyun.com/g\\" /etc/apt/sources.list RUN sed -i \\"s/security.debian.org/mirrors.aliyun.com\\\\/debian-security/g\\" /etc/apt/sources.list RUN apt-get update &amp;&amp; \\\\ apt-get install -y curl vim git &amp;&amp; \\\\ apt-get clean # maven RUN curl -OL https://archive.apache.org/dist/maven/maven-3/${MAVEN_VERSION}/binaries/apache-maven-${MAVEN_VERSION}-bin.tar.gz &amp;&amp; \\\\ tar -zxf ./apache-maven-${MAVEN_VERSION}-bin.tar.gz &amp;&amp; \\\\ mv apache-maven-${MAVEN_VERSION} /usr/local &amp;&amp; \\\\ rm -f apache-maven-${MAVEN_VERSION}-bin.tar.gz &amp;&amp; \\\\ ln -s /usr/local/apache-maven-${MAVEN_VERSION}/bin/mvn /usr/bin/mvn &amp;&amp; \\\\ ln -s /usr/local/apache-maven-${MAVEN_VERSION} /usr/local/apache-maven &amp;&amp; \\\\ mkdir -p /home/jenkins/.m2 &amp;&amp; \\\\ chown -R jenkins:jenkins /home/jenkins/.m2 # kubectl RUN curl -OL https://storage.googleapis.com/kubernetes-release/release/${KUBECTL_VERSION}/bin/linux/amd64/kubectl &amp;&amp; \\\\ chmod +x ./kubectl &amp;&amp; \\\\ mv ./kubectl /usr/local/bin/kubectl &amp;&amp; \\\\ ln -snf /usr/share/zoneinfo/$TZ /etc/localtime &amp;&amp; \\\\ echo $TZ &gt; /etc/timezone VOLUME [ \\"/home/jenkins/.m2\\" ] # USER jenkins ENTRYPOINT [\\"/usr/local/bin/jenkins-agent\\"] # docker build --build-arg KUBECTL_VERSION=v1.22.3 --build-arg MAVEN_VERSION=3.6.3 -t \\"yhma/kubectl-maven-agent\\" . # docker push yhma/kubectl-maven-agent","head":[["meta",{"property":"og:url","content":"https://Alpha-yhma.github.io/md/devops/jenkins/jenkins-agent-build.html"}],["meta",{"property":"og:site_name","content":"Ikaros"}],["meta",{"property":"og:title","content":"Jenkins agent镜像构建"}],["meta",{"property":"og:description","content":"FROM jenkins/inbound-agent:latest-jdk11 ARG MAVEN_VERSION=3.6.3 ARG KUBECTL_VERSION=v1.22.1 USER root # tool RUN sed -i \\"s/deb.debian.org/mirrors.aliyun.com/g\\" /etc/apt/sources.list RUN sed -i \\"s/security.debian.org/mirrors.aliyun.com\\\\/debian-security/g\\" /etc/apt/sources.list RUN apt-get update &amp;&amp; \\\\ apt-get install -y curl vim git &amp;&amp; \\\\ apt-get clean # maven RUN curl -OL https://archive.apache.org/dist/maven/maven-3/${MAVEN_VERSION}/binaries/apache-maven-${MAVEN_VERSION}-bin.tar.gz &amp;&amp; \\\\ tar -zxf ./apache-maven-${MAVEN_VERSION}-bin.tar.gz &amp;&amp; \\\\ mv apache-maven-${MAVEN_VERSION} /usr/local &amp;&amp; \\\\ rm -f apache-maven-${MAVEN_VERSION}-bin.tar.gz &amp;&amp; \\\\ ln -s /usr/local/apache-maven-${MAVEN_VERSION}/bin/mvn /usr/bin/mvn &amp;&amp; \\\\ ln -s /usr/local/apache-maven-${MAVEN_VERSION} /usr/local/apache-maven &amp;&amp; \\\\ mkdir -p /home/jenkins/.m2 &amp;&amp; \\\\ chown -R jenkins:jenkins /home/jenkins/.m2 # kubectl RUN curl -OL https://storage.googleapis.com/kubernetes-release/release/${KUBECTL_VERSION}/bin/linux/amd64/kubectl &amp;&amp; \\\\ chmod +x ./kubectl &amp;&amp; \\\\ mv ./kubectl /usr/local/bin/kubectl &amp;&amp; \\\\ ln -snf /usr/share/zoneinfo/$TZ /etc/localtime &amp;&amp; \\\\ echo $TZ &gt; /etc/timezone VOLUME [ \\"/home/jenkins/.m2\\" ] # USER jenkins ENTRYPOINT [\\"/usr/local/bin/jenkins-agent\\"] # docker build --build-arg KUBECTL_VERSION=v1.22.3 --build-arg MAVEN_VERSION=3.6.3 -t \\"yhma/kubectl-maven-agent\\" . # docker push yhma/kubectl-maven-agent"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2023-12-11T11:50:12.000Z"}],["meta",{"property":"article:author","content":"yhma"}],["meta",{"property":"article:tag","content":"Jenkins"}],["meta",{"property":"article:modified_time","content":"2023-12-11T11:50:12.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Jenkins agent镜像构建\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2023-12-11T11:50:12.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"yhma\\",\\"url\\":\\"https://github.com/Alpha-yhma/Alpha-yhma.github.io\\"}]}"]]},"headers":[],"git":{"createdTime":1702295412000,"updatedTime":1702295412000,"contributors":[{"name":"yhma","email":"44752536+Alpha-yhma@users.noreply.github.com","commits":1}]},"readingTime":{"minutes":0.52,"words":155},"filePathRelative":"md/devops/jenkins/jenkins-agent-build.md","localizedDate":"2023年12月11日","excerpt":"<div class=\\"language-Dockerfile line-numbers-mode\\" data-ext=\\"Dockerfile\\"><pre class=\\"language-Dockerfile\\"><code>FROM jenkins/inbound-agent:latest-jdk11\\n\\nARG MAVEN_VERSION=3.6.3\\nARG KUBECTL_VERSION=v1.22.1\\n\\nUSER root\\n\\n# tool\\n\\nRUN sed -i \\"s/deb.debian.org/mirrors.aliyun.com/g\\" /etc/apt/sources.list\\nRUN sed -i \\"s/security.debian.org/mirrors.aliyun.com\\\\/debian-security/g\\" /etc/apt/sources.list\\n\\n\\nRUN apt-get update &amp;&amp; \\\\\\n  apt-get install -y curl vim git &amp;&amp; \\\\\\n  apt-get clean\\n\\n# maven\\nRUN curl -OL https://archive.apache.org/dist/maven/maven-3/${MAVEN_VERSION}/binaries/apache-maven-${MAVEN_VERSION}-bin.tar.gz &amp;&amp; \\\\\\n  tar -zxf ./apache-maven-${MAVEN_VERSION}-bin.tar.gz &amp;&amp; \\\\\\n  mv apache-maven-${MAVEN_VERSION} /usr/local &amp;&amp; \\\\\\n  rm -f apache-maven-${MAVEN_VERSION}-bin.tar.gz &amp;&amp; \\\\\\n  ln -s /usr/local/apache-maven-${MAVEN_VERSION}/bin/mvn /usr/bin/mvn &amp;&amp; \\\\\\n  ln -s /usr/local/apache-maven-${MAVEN_VERSION} /usr/local/apache-maven &amp;&amp; \\\\\\n  mkdir -p /home/jenkins/.m2  &amp;&amp; \\\\\\n  chown -R jenkins:jenkins  /home/jenkins/.m2\\n\\n# kubectl\\nRUN curl -OL https://storage.googleapis.com/kubernetes-release/release/${KUBECTL_VERSION}/bin/linux/amd64/kubectl &amp;&amp; \\\\\\n  chmod +x ./kubectl &amp;&amp; \\\\\\n  mv ./kubectl /usr/local/bin/kubectl &amp;&amp; \\\\\\n  ln -snf /usr/share/zoneinfo/$TZ /etc/localtime &amp;&amp; \\\\\\n  echo $TZ &gt; /etc/timezone\\n\\nVOLUME [ \\"/home/jenkins/.m2\\" ]\\n\\n# USER jenkins\\n\\nENTRYPOINT [\\"/usr/local/bin/jenkins-agent\\"]\\n\\n# docker build --build-arg KUBECTL_VERSION=v1.22.3 --build-arg MAVEN_VERSION=3.6.3 -t \\"yhma/kubectl-maven-agent\\" .\\n# docker push yhma/kubectl-maven-agent\\n\\n</code></pre><div class=\\"line-numbers\\" aria-hidden=\\"true\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}');export{e as data};
