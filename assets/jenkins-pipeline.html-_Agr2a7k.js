import{_ as n}from"./plugin-vue_export-helper-x3n3nnut.js";import{o as s,c as a,f as t}from"./app-giQjudzF.js";const p={},o=t(`<div class="language-groovy line-numbers-mode" data-ext="groovy"><pre class="language-groovy"><code><span class="token keyword">def</span> label <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">&quot;slave-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token expression">UUID<span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span></span>
 
<span class="token function">podTemplate</span><span class="token punctuation">(</span>label<span class="token punctuation">:</span> label<span class="token punctuation">,</span> containers<span class="token punctuation">:</span> <span class="token punctuation">[</span>
  <span class="token function">containerTemplate</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string">&#39;maven&#39;</span><span class="token punctuation">,</span> image<span class="token punctuation">:</span> <span class="token string">&#39;maven:latest&#39;</span><span class="token punctuation">,</span> command<span class="token punctuation">:</span> <span class="token string">&#39;cat&#39;</span><span class="token punctuation">,</span> ttyEnabled<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">containerTemplate</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string">&#39;docker&#39;</span><span class="token punctuation">,</span> image<span class="token punctuation">:</span> <span class="token string">&#39;docker:latest&#39;</span><span class="token punctuation">,</span> command<span class="token punctuation">:</span> <span class="token string">&#39;cat&#39;</span><span class="token punctuation">,</span> ttyEnabled<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">containerTemplate</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string">&#39;kubectl&#39;</span><span class="token punctuation">,</span> image<span class="token punctuation">:</span> <span class="token string">&#39;kubesphere/kubectl&#39;</span><span class="token punctuation">,</span> command<span class="token punctuation">:</span> <span class="token string">&#39;cat&#39;</span><span class="token punctuation">,</span> ttyEnabled<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span> serviceAccount<span class="token punctuation">:</span> <span class="token string">&#39;jenkins&#39;</span><span class="token punctuation">,</span> volumes<span class="token punctuation">:</span> <span class="token punctuation">[</span>
  <span class="token function">hostPathVolume</span><span class="token punctuation">(</span>mountPath<span class="token punctuation">:</span> <span class="token string">&#39;/root/.m2&#39;</span><span class="token punctuation">,</span> hostPath<span class="token punctuation">:</span> <span class="token string">&#39;/root/.m2&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">hostPathVolume</span><span class="token punctuation">(</span>mountPath<span class="token punctuation">:</span> <span class="token string">&#39;/root/.kube&#39;</span><span class="token punctuation">,</span> hostPath<span class="token punctuation">:</span> <span class="token string">&#39;/root/.kube&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">hostPathVolume</span><span class="token punctuation">(</span>mountPath<span class="token punctuation">:</span> <span class="token string">&#39;/var/run/docker.sock&#39;</span><span class="token punctuation">,</span> hostPath<span class="token punctuation">:</span> <span class="token string">&#39;/var/run/docker.sock&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">node</span><span class="token punctuation">(</span>label<span class="token punctuation">)</span> <span class="token punctuation">{</span>
 
    <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">&#39;单元测试&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      echo <span class="token interpolation-string"><span class="token string">&quot;测试阶段&quot;</span></span>
    <span class="token punctuation">}</span>
    <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">&#39;代码编译打包&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">container</span><span class="token punctuation">(</span><span class="token string">&#39;maven&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          
        <span class="token comment">//   git &#39;https://github.com/mybatis/spring-boot-starter.git&#39;</span>
          
          <span class="token function">withCredentials</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">file</span><span class="token punctuation">(</span>credentialsId<span class="token punctuation">:</span> <span class="token string">&#39;maven-settings&#39;</span><span class="token punctuation">,</span> variable<span class="token punctuation">:</span> <span class="token string">&#39;SETTINGS&#39;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              echo <span class="token interpolation-string"><span class="token string">&quot;查看 K8S 集群 Pod 列表&quot;</span></span>
              sh <span class="token interpolation-string"><span class="token string">&quot;mkdir -p ~/.m2 &amp;&amp; cp </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token expression">SETTINGS</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> ~/.m2/settings.xml&quot;</span></span>
            <span class="token comment">//   sh &#39;mvn clean compile -DskipTests -T10&#39;</span>
            <span class="token punctuation">}</span>

      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">&#39;构建 Docker 镜像&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">container</span><span class="token punctuation">(</span><span class="token string">&#39;docker&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        echo <span class="token interpolation-string"><span class="token string">&quot;构建 Docker 镜像阶段&quot;</span></span>
        sh <span class="token string">&#39;docker ps&#39;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">&#39;运行 Kubectl&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">container</span><span class="token punctuation">(</span><span class="token string">&#39;kubectl&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        echo <span class="token interpolation-string"><span class="token string">&quot;查看 K8S 集群 Pod 列表&quot;</span></span>
        <span class="token comment">// sh &#39;echo $USER&#39;</span>
        sh <span class="token interpolation-string"><span class="token string">&quot;kubectl get pods&quot;</span></span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),c=[o];function e(i,u){return s(),a("div",null,c)}const r=n(p,[["render",e],["__file","jenkins-pipeline.html.vue"]]);export{r as default};
